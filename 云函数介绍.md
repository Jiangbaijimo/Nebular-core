
Owner Avatar
æ•™ç¨‹ / Mix Space, Shiro
Mix-Spaceäº‘å‡½æ•°å¤‡å¿˜
 jc/Mix-Cloud-Function
åå²äº‘å°å±‹

Mix-Spaceäº‘å‡½æ•°å¤‡å¿˜
2024 å¹´ 8 æœˆ 17 æ—¥ æ˜ŸæœŸå…­
(å·²ç¼–è¾‘)
æ•™ç¨‹ / Mix Space, Shiro
201
3
AI ç”Ÿæˆçš„æ‘˜è¦
æ­¤å†…å®¹ç”± AI ç”Ÿæˆ
äº‘å‡½æ•°æ˜¯ Mix Space ä¸­çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½ï¼Œå®ƒæå¤§åœ°è¾…åŠ©äº†ä½¿ç”¨è€…åœ¨ Mix Space ä¸­çš„ä½“éªŒã€‚é€šè¿‡äº‘å‡½æ•°ï¼ŒMix Space å¯ä»¥é¢å¤–å®ç°å®ç°æ­Œå•è§£æï¼Œè¿½ç•ªåˆ—è¡¨ç­‰ç­‰çš„åŠŸèƒ½ã€‚
è¿™ç¯‡æ–‡ç« ä¸Šæ¬¡ä¿®æ”¹äº 2024 å¹´ 11 æœˆ 3 æ—¥ æ˜ŸæœŸæ—¥ï¼Œå¯èƒ½éƒ¨åˆ†å†…å®¹å·²ç»ä¸é€‚ç”¨ï¼Œå¦‚æœ‰ç–‘é—®å¯è¯¢é—®ä½œè€…ã€‚
Mix-Spaceäº‘å‡½æ•°å¤‡å¿˜
äº‘å‡½æ•°æ˜¯ Mix Space ä¸­çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½ï¼Œå®ƒæå¤§åœ°è¾…åŠ©äº†ä½¿ç”¨è€…åœ¨ Mix Space ä¸­çš„ä½“éªŒã€‚é€šè¿‡äº‘å‡½æ•°ï¼ŒMix Space å¯ä»¥é¢å¤–å®ç°å®ç°æ­Œå•è§£æï¼Œè¿½ç•ªåˆ—è¡¨ç­‰ç­‰çš„åŠŸèƒ½ã€‚

å»ºè®®é£Ÿç”¨å®˜æ–¹æ–‡æ¡£ https://mx-space.js.org/usage æœ¬ç¯‡ä»…ä½œå‚è€ƒ

å¿«é€Ÿå¯¼å…¥
å…·ä½“é…ç½®éœ€è¦ä¸€ä¸ªä¸€ä¸ªä¿®æ”¹ï¼Œæœ€å¤šå…å»äº†åˆ›å»ºè¿‡ç¨‹ã€‚


Shiroä¸»é¢˜
ä¸»é¢˜é…ç½®
è¿™ä¸ªæ˜¯æˆ‘å½“å‰é…ç½® ï¼Œä»…ä¾›å‚è€ƒï¼Œæ ¹æ®éœ€è¦æ›´æ”¹

Mix-Space åå°ï¼Œè¿›å…¥ã€Œé…ç½®ä¸äº‘å‡½æ•°ã€é¡µé¢ï¼Œç‚¹å‡»å³ä¸Šè§’çš„æ–°å¢æŒ‰é’®ï¼Œåœ¨ç¼–è¾‘é¡µé¢ä¸­ï¼Œå¡«å…¥ä»¥ä¸‹è®¾ç½®ï¼š

åç§°ï¼šshiro
å¼•ç”¨ï¼štheme
æ•°æ®ç±»å‹ï¼šJSON


{
# ç«™ç‚¹åº•éƒ¨ç›¸å…³ä¿¡æ¯
"footer": { 
  "otherInfo": {
    "date": "2022-{{now}}",
    "icp": {
      "text": "è±« ICP å¤‡ 2022029096å·-2",
      "link": "https://beian.miit.gov.cn"
    }
  },
  "linkSections": [
    {
      "name": "ğŸ˜Šå…³äº",
      "links": [
        {
          "name": "å…³äºæˆ‘",
          "href": "/about"
        },
        {
          "name": "å…³äºæ­¤é¡¹ç›®",
          "href": "https://github.com/innei/Shiro",
          "external": true
        }
      ]
    },
    {
      "name": "ğŸ§æ›´å¤š",
      "links": [
        {
          "name": "æ—¶é—´çº¿",
          "href": "/timeline"
        },
        {
          "name": "å‹é“¾",
          "href": "/friends"
        },
        {
          "name": "æ€è€ƒ",
          "href": "/thinking",
          "external": true
        }
      ]
    },
    {
      "name": "ğŸ¤—è”ç³»",
      "links": [
        {
          "name": "å†™ç•™è¨€",
          "href": "/message"
        },
        {
          "name": "å‘é‚®ä»¶",
          "href": "mailto:i@vlo.cc",
          "external": true
        },
        {
          "name": "GitHub",
          "href": "https://github.com/jiuyue52",
          "external": true
        }
      ]
    }
  ]
},
"config": {
  "color": {
    "light": [
      "#33A6B8",
      "#FF6666",
      "#26A69A",
      "#fb7287",
      "#69a6cc",
      "#F11A7B",
      "#78C1F3",
      "#FF6666",
      "#7ACDF6"
    ],
    "dark": [
      "#F596AA",
      "#A0A7D4",
      "#ff7b7b",
      "#99D8CF",
      "#838BC6",
      "#FFE5AD",
      "#9BE8D8",
      "#A1CCD1",
      "#EAAEBA"
    ]
  },
  "custom": {
    "css": [],
    "styles": [],
    "js": [],
    "scripts": []
  },
   # ç«™ç‚¹å›¾æ ‡
  "site": {
    "favicon": "https://mio.vlo.cc/resource/image/J99Y.svg",
    "faviconDark": "https://mio.vlo.cc/resource/image/J99Y.svg"
  },
  "hero": {
    "title": {
      "template": [
        {
          "type": "h1",
          "text": "Hi, I'm ",
          "class": "font-light text-4xl"
        },
        {
          "type": "h1",
          "text": "JiuYue",
          "class": "font-medium mx-2 text-4xl"
        },
        {
          "type": "h1",
          "text": "ğŸ‘‹ã€‚",
          "class": "font-light text-4xl"
        },
        {
          "type": "br"
        },
        {
          "type": "h1",
          "text": "è¯­è¨€æ˜¯æ€æƒ³çš„ç›´æ¥çš„ç°å®",
          "class": "font-light text-4xl"
        },
        {
          "type": "code",
          "text": "<Developer />",
          "class": "font-medium mx-2 text-3xl rounded p-1 bg-gray-200 dark:bg-gray-800/0 hover:dark:bg-gray-800/100 bg-opacity-0 hover:bg-opacity-100 transition-background duration-200"
        },
        {
          "type": "span",
          "class": "inline-block w-[1px] h-8 -bottom-2 relative bg-gray-800/80 dark:bg-gray-200/80 opacity-0 group-hover:opacity-100 transition-opacity duration-200 group-hover:animation-blink"
        }
      ]
    },
    # hitokotoé—­æºä¸“å±ï¼Œé¦–é¡µéšæœºä¸€è¨€
    "hitokoto": {
      "random": true
    },
    "description": "å†…å¿ƒæ¹›ç„¶ï¼Œåˆ™æ— å¾€è€Œä¸ä¹ã€‚"
  },
  "module": { 
    # æˆ‘çš„åŠ¨æ€
    "activity": { 
      "enable": true,
      "endpoint": "/fn/ps/update"
    },
    # æ‰“èµåœ°å€åŠæ”¶æ¬¾äºŒç»´ç 
    "donate": {
      "enable": true, 
      "link": "https://afdian.net/@huasui",
      "qrcode": [
        "https://mio.vlo.cc/image/2408/66b853da25ce7.webp",
        "https://mio.vlo.cc/image/2408/66b853da25ce7.webp"
      ]
    },
    # bç«™ç›´æ’­é—´æˆ¿é—´å·ï¼Œè·å–ç›´æ’­çŠ¶æ€
    "bilibili": { 
      "liveId": 23359061 
    },
    # svgç­¾ååŠ¨ç”»ï¼Œshiroié—­æºç‰ˆä¸“å±
    "signature": { 
      "svg": ""  
    }
  }
}
}
æˆ‘çš„åŠ¨æ€
éœ€è¦åœ¨ä¸»é¢˜é…ç½®ä¸­é…ç½®æˆ‘çš„åŠ¨æ€æ¨¡å—

æ–°å»ºäº‘å‡½æ•°

åç§°ï¼šupdate
å¼•ç”¨ï¼šps
æ•°æ®ç±»å‹ï¼šFunction
è¯·æ±‚æ–¹å¼ï¼šPOST
è¿™ä¸ªåœ°æ–¹è¿˜éœ€è¦è®¾ç½®ä¸€ä¸ªå¯†é’¥ï¼Œåœ¨ Secret ä¸­å¡«å…¥ keyï¼Œåœ¨ Value ä¸­å¡«å…¥ä½ è‡ªå·±çš„å¯†é’¥ã€‚


export default async function handler(ctx: Context) {
  const {
    timestamp,
    process: processName,
    key,
    media,
    meta,
  } = ctx.req.body || {}
  // handle GET
  {
    const [processInfo, mediaInfo] = await Promise.all([
      ctx.storage.cache.get('ps') as any as Promise<Process | undefined>,
      ctx.storage.cache.get('media') as any as Promise<Media | undefined>,
    ])
    if (!key) {
      return {
        processName: processInfo?.name,
        processInfo,
        mediaInfo,
      }
    }
  }
  const ts = +new Date()
  // if (Math.abs(ts - timestamp) > 1000 * 10) {
  //   ctx.throws(400, 'this request is outdate')
  //   return
  // }
  const processInfo: Process = {
    name: processName,
    ...meta,
  }
  const validKey = (await ctx.secret.key) || 'testing'
  if (key != validKey)
    ctx.throws(401, "You haven't permission to update process info")
  const originalPsInfo: Process | null = (await ctx.storage.cache.get(
    'ps',
  )) as any
  await ctx.storage.cache.set('ps', processInfo, 300)
  if (originalPsInfo?.name !== processName)
    ctx?.broadcast?.('ps-update', {
      processInfo,
      process: processInfo.name,
      ts,
    })
  if (media) {
    await ctx.storage.cache.set('media', media, 10)
  }
  const mediaInfo: Media | undefined = (await ctx.storage.cache.get(
    'media',
  )) as any
  if (mediaInfo?.title !== media?.title)
    ctx?.broadcast?.('media-update', media || null)
  return {
    ok: 1,
    mediaInfo,
    process: processInfo.name,
    processInfo,
    timestamp: +new Date(),
  }
}
interface Media {
  title: string
  artist: string
}
interface Process {
  name: string
  iconBase64?: string
  iconUrl?: string
  description?: string
}

å±•å¼€
å¦å¤–éœ€è¦ä¸‹è½½å¯¹åº”å¹³å°çš„çŠ¶æ€ä¸ŠæŠ¥è½¯ä»¶
å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š https://mx-space.js.org/themes/shiro/extra#é…ç½®è½¯ä»¶

ä¸ªäººçŠ¶æ€ï¼ˆé—­æºä¸“å±ï¼‰

æ–°å»ºäº‘å‡½æ•°

åç§°ï¼šstatus
å¼•ç”¨ï¼šshiro
æ•°æ®ç±»å‹ï¼šFunction
è¯·æ±‚æ–¹å¼ï¼šALL
è¿™ä¸ªåœ°æ–¹è¿˜éœ€è¦è®¾ç½®ä¸€ä¸ªå¯†é’¥ï¼Œåœ¨ Secret ä¸­å¡«å…¥ keyï¼Œåœ¨ Value ä¸­å¡«å…¥ä½ è‡ªå·±çš„å¯†é’¥ã€‚


interface Status {
  emoji: string
  icon?: string
  desc?: string
  ttl: number
  untilAt: number
}
function assetAuth(ctx: Context) {
  const body = ctx.req.body
  const authKey = ctx.secret.key
  if (ctx.isAuthenticated) return
  if (body.key !== authKey) {
    ctx.throws(401, 'Unauthorized')
  }
}
export default async function handler(ctx: Context) {
  const method = ctx.req.method.toLowerCase()
  switch (method) {
    case 'get': {
      return GET(ctx)
    }
    case 'post': {
      assetAuth(ctx)
      return POST(ctx)
    }
    case 'delete': {
      assetAuth(ctx)
      return DELETE(ctx)
    }
    default: {
      ctx.throws(405, 'Method Not Allowed')
    }
  }
}
const cacheKey = 'shiro:status'
function DELETE(ctx: Context) {
  ctx.storage.cache.del(cacheKey)
  ctx.broadcast('shiro#status', null)
}
function POST(ctx: Context) {
  const body = ctx.req.body
  const { emoji, icon, desc } = body as Status
  const ttl = body.ttl || 86400 // 1 day
  const status = {
    emoji,
    icon,
    desc,
    ttl,
    untilAt: Date.now() + ttl * 1000,
  } as Status
  ctx.storage.cache.set(cacheKey, JSON.stringify(status), ttl)
  ctx.status(204)
  ctx.broadcast('shiro#status', status)
}
function GET(ctx: Context) {
  const status = ctx.storage.cache.get(cacheKey)
  ctx.res.type('application/json')
  return status
}

å±•å¼€
è®¾ç½®çŠ¶æ€ï¼Œå‰ç«¯é¦–é¡µ->åŒå‡»å·¦ä¸Šè§’å¤´åƒ->ç™»å½•ï¼Œç‚¹å‡»å·¦ä¸Šè§’å¤´åƒçš„å³ä¸‹æ–¹è®¾ç½®çŠ¶æ€ã€‚

svgç­¾ååŠ¨ç”»ï¼ˆé—­æºä¸“å±ï¼‰

åœ¨ä¸»é¢˜é…ç½®ä»£ç ä¸­æ‰¾åˆ° moduleï¼ŒåŠ å…¥ signature é…ç½®ï¼Œ

å—é™äº Json è¯­æ³•è§„åˆ™ï¼Œæ­¤å¤„ svg ä»£ç éœ€æ›¿æ¢æ‰€æœ‰çš„ " ä¸º \ "ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

æ–‡ç« æ ‡é¢˜ï¼šMix-Spaceäº‘å‡½æ•°å¤‡å¿˜

æ–‡ç« ä½œè€…ï¼šç–æœˆ

æ–‡ç« é“¾æ¥ï¼šhttps://www.vlo.cc/posts/jc/Mix-Cloud-Function 

æœ€åä¿®æ”¹æ—¶é—´: 2024 å¹´ 11 æœˆ 03 æ—¥ 10:42

å•†ä¸šè½¬è½½è¯·è”ç³»ç«™é•¿è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜æœ¬æ–‡å‡ºå¤„åŠæ–‡ç« é“¾æ¥ï¼Œæ‚¨å¯ä»¥è‡ªç”±åœ°åœ¨ä»»ä½•åª’ä½“ä»¥ä»»ä½•å½¢å¼å¤åˆ¶å’Œåˆ†å‘ä½œå“ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹å’Œåˆ›ä½œï¼Œä½†æ˜¯åˆ†å‘è¡ç”Ÿä½œå“æ—¶å¿…é¡»é‡‡ç”¨ç›¸åŒçš„è®¸å¯åè®®ã€‚
æœ¬æ–‡é‡‡ç”¨CC BY-NC-SA 4.0 - éå•†ä¸šæ€§ä½¿ç”¨ - ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è¿›è¡Œè®¸å¯ã€‚

ä½¿ç”¨ç¤¾äº¤è´¦å·ç™»å½•




LILAC
ç™»å½•è²Œä¼¼å‡ºbugäº† ä¸ºä»€ä¹ˆåªèƒ½å…ç™»å½•è¯„è®º ğŸ¤”

ç–æœˆ
emmmmå‰åç«¯æ›´æ–°åå°±ç‚¸äº†ï¼Œä¸çŸ¥é“å“ªçš„é—®é¢˜ğŸ˜­

LILAC
ç™»å½•è²Œä¼¼å‡ºbugäº† ä¸ºä»€ä¹ˆåªèƒ½å…ç™»å½•è¯„è®º ğŸ¤”

ç–æœˆ
emmmmå‰åç«¯æ›´æ–°åå°±ç‚¸äº†ï¼Œä¸çŸ¥é“å“ªçš„é—®é¢˜ğŸ˜­

LILAC
æˆ‘ä¹Ÿæäº†å¥½ä¹…éƒ½æ²¡è°ƒæˆåŠŸ ä½†æˆ‘å‘ç°æœ‰çš„äººæ˜¯æ­£å¸¸çš„ å¯èƒ½æ˜¯ç‰ˆæœ¬é—®é¢˜å§ ğŸ˜‚

ç–æœˆ
æˆ‘ç°åœ¨åç«¯éªŒè¯ç›´æ¥403ã€‚ã€‚ã€‚å¤ªè‰äº†ğŸ˜‚ç¾¤é‡Œä¹‹å‰æ­£å¸¸çš„æ›´æ–°å®Œä¹Ÿç‚¸äº†ï¼Œæˆ‘æ„Ÿè§‰æ²¡ç‚¸çš„éƒ½æ²¡æ›´æ–°ï¼ˆ

ç–æœˆ
core7.2.4ä¿®å¥½äº†

LILAC
æˆ‘å»çœ‹ä¸‹ è°¢è°¢ä½ å•¦ (o^â–½^o)

snake
å¥½å•Šå¥½å•Šã€‚æˆ‘ä¹ŸæŠ„ä½ è¿™é‡Œçš„

Huasui
hhhhhï¼ˆ

å°å…ƒ
çˆ½äº†æˆ‘å®£å¸ƒè¿™æ˜¯mx-spaceå®˜æ–¹ç½‘ç«™ï¼ï¼ˆç‹—å¤´ ğŸ˜

ç–æœˆ
(Â¬â€¿Â¬ ) å…¶å®å°±æ˜¯cvçš„å®˜æ–¹æ–‡æ¡£ï¼ˆ

å¿«é€Ÿå¯¼å…¥
Shiroä¸»é¢˜
ä¸»é¢˜é…ç½®
æˆ‘çš„åŠ¨æ€
ä¸ªäººçŠ¶æ€ï¼ˆé—­æºä¸“å±ï¼‰
svgç­¾ååŠ¨ç”»ï¼ˆé—­æºä¸“å±ï¼‰
100%

å›åˆ°é¡¶éƒ¨

3



ğŸ˜Šå…³äº
å…³äºæˆ‘éšç§æƒ
ğŸ§æ›´å¤š
æ—¶é—´çº¿æœ‹å‹ä»¬æ€è€ƒ
ğŸ¤—è”ç³»
å†™ç•™è¨€å‘é‚®ä»¶GitHub
Â© 2022-2025 ç–æœˆ.RSSç«™ç‚¹åœ°å›¾è®¢é˜…Stay hungry. Stay foolish.
Powered by Mix Space&ç™½ã„.è±« ICP å¤‡ 2022029096å·-2
æ­£åœ¨è¢« 1 äººçœ‹çˆ†



ğŸ‘‹ğŸ»